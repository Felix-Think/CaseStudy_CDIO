
<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Nhập Case</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <template id="success-criterion-template">
    <div
      data-success-criterion
      class="rounded-2xl border border-slate-200 bg-white/80 p-4 shadow-inner space-y-4"
    >
      <div class="flex flex-wrap items-center justify-between gap-3">
        <span class="text-sm font-semibold text-slate-800">Tiêu chí</span>
        <button
          type="button"
          data-remove-success-criterion
          class="text-xs font-semibold text-slate-500 transition hover:text-rose-500 focus:outline-none"
        >
          Xóa
        </button>
      </div>
      <label class="block text-xs font-semibold uppercase tracking-wide text-slate-500">
        Mô tả tiêu chí
        <input
          type="text"
          data-criterion-description
          placeholder="ví dụ: CPR – Đánh giá hiệu quả..."
          class="mt-2 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-700 placeholder:text-slate-400 focus:border-primary-200 focus:outline-none focus:ring-2 focus:ring-primary-100"
        />
      </label>
      <div class="grid gap-3 md:grid-cols-2">
        <label class="text-xs font-semibold uppercase tracking-wide text-slate-500">
          Mức 5 (Xuất sắc)
          <textarea
            rows="2"
            data-level-descriptor="5"
            placeholder="Mô tả cụ thể cho điểm 5."
            class="mt-2 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-700 placeholder:text-slate-400 focus:border-primary-200 focus:outline-none focus:ring-2 focus:ring-primary-100"
          ></textarea>
        </label>
        <label class="text-xs font-semibold uppercase tracking-wide text-slate-500">
          Mức 4
          <textarea
            rows="2"
            data-level-descriptor="4"
            placeholder="Mô tả cụ thể cho điểm 4."
            class="mt-2 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-700 placeholder:text-slate-400 focus:border-primary-200 focus:outline-none focus:ring-2 focus:ring-primary-100"
          ></textarea>
        </label>
        <label class="text-xs font-semibold uppercase tracking-wide text-slate-500">
          Mức 3
          <textarea
            rows="2"
            data-level-descriptor="3"
            placeholder="Mô tả cụ thể cho điểm 3."
            class="mt-2 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-700 placeholder:text-slate-400 focus:border-primary-200 focus:outline-none focus:ring-2 focus:ring-primary-100"
          ></textarea>
        </label>
        <label class="text-xs font-semibold uppercase tracking-wide text-slate-500">
          Mức 2
          <textarea
            rows="2"
            data-level-descriptor="2"
            placeholder="Mô tả cụ thể cho điểm 2."
            class="mt-2 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-700 placeholder:text-slate-400 focus:border-primary-200 focus:outline-none focus:ring-2 focus:ring-primary-100"
          ></textarea>
        </label>
        <label class="text-xs font-semibold uppercase tracking-wide text-slate-500 md:col-span-2">
          Mức 1 (Thấp nhất)
          <textarea
            rows="2"
            data-level-descriptor="1"
            placeholder="Mô tả cụ thể cho điểm 1."
            class="mt-2 w-full rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-700 placeholder:text-slate-400 focus:border-primary-200 focus:outline-none focus:ring-2 focus:ring-primary-100"
          ></textarea>
        </label>
      </div>
    </div>
  </template>

  <script src="/static/nhap-case.tailwind.js"></script>
  <style>
    :root {
      font-family: Arial, ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    }
    body,
    input,
    textarea,
    button,
    select {
      font-family: inherit;
    }
  </style>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <link rel="stylesheet" href="/static/styles.css" />
</head>
<body class="min-h-screen bg-slate-50 text-slate-800">
  <div class="relative flex min-h-screen flex-col">
    <div class="absolute inset-0 -z-10 bg-gradient-to-br from-primary-50 via-white to-slate-100"></div>
    <header class="sticky top-0 z-40 border-b border-slate-100 bg-white/80 backdrop-blur">
      <div class="mx-auto flex max-w-6xl items-center justify-between px-6 py-4">
        <a href="/quan-ly-case" class="text-sm font-semibold text-primary-600 transition hover:text-primary-500">Quay lại quản lý case</a>
      </div>
    </header>
    <main class="flex-1 px-6 py-12">
      <div class="mx-auto flex max-w-6xl flex-col gap-12">
        <section class="rounded-3xl border border-dashed border-primary-200 bg-white/80 p-8 shadow-sm">
          <div class="flex flex-col items-center gap-3 text-center">
            <span class="inline-flex items-center gap-2 rounded-full bg-primary-100 px-4 py-1 text-xs font-semibold uppercase tracking-wide text-primary-700">
              Nhập dữ liệu từ JSON
            </span>
            <h1 class="text-3xl font-semibold text-slate-900">Trang Nhập Case</h1>
            <p class="max-w-2xl text-sm text-slate-600">
              Tải lần lượt 3 tệp Skeleton, Context và Personas để tự động điền biểu mẫu. Bạn vẫn có thể chỉnh sửa thủ công trước khi lưu case.
            </p>
          </div>
          <div class="mt-6 flex flex-col items-center gap-2 text-center">
            <button
              type="button"
              data-open-draft
              class="inline-flex items-center gap-2 rounded-full bg-emerald-600 px-5 py-2 text-sm font-semibold text-white shadow transition hover:bg-emerald-500 focus:outline-none focus:ring-2 focus:ring-emerald-200"
            >
              Sinh case tự động
            </button>
            <p class="text-xs text-slate-500">
              Nhập prompt tự do hoặc chủ đề chi tiết để hệ thống gợi ý case hoàn chỉnh nhanh chóng.
            </p>
          </div>
          <div class="mt-8 grid gap-4 md:grid-cols-3">
            <div
              class="group flex cursor-pointer flex-col items-center gap-3 rounded-2xl border-2 border-dashed border-primary-100 bg-white/70 p-6 text-center transition duration-200 focus-within:border-primary-300 focus-within:shadow hover:border-primary-300 hover:bg-primary-50"
              data-json-card="skeleton"
              tabindex="0"
              role="button"
              aria-label="Nhập file Skeleton JSON"
            >
              <input type="file" accept="application/json" class="hidden" data-json-input="skeleton" />
              <span class="text-xs font-semibold uppercase tracking-wide text-primary-700">Skeleton JSON</span>
              <p class="text-sm font-semibold text-slate-900">Chọn tệp skeleton.json</p>
              <p class="max-w-[16rem] text-xs text-slate-500" data-json-status="skeleton">Chưa chọn file</p>
              <div class="flex flex-wrap items-center justify-center gap-2">
                <button
                  type="button"
                  data-json-select="skeleton"
                  class="rounded-full bg-primary-600 px-4 py-1.5 text-xs font-semibold text-white transition hover:bg-primary-500 focus:outline-none focus:ring-2 focus:ring-primary-200"
                >
                  Chọn file
                </button>
                <button
                  type="button"
                  data-json-export="skeleton"
                  class="rounded-full border border-primary-200 px-4 py-1.5 text-xs font-semibold text-primary-600 transition hover:bg-primary-50 focus:outline-none focus:ring-2 focus:ring-primary-200"
                >
                  Luu JSON
                </button>
                <button
                  type="button"
                  data-json-clear="skeleton"
                  class="rounded-full border border-slate-200 px-4 py-1.5 text-xs font-semibold text-slate-500 transition hover:border-slate-300 hover:text-slate-700 focus:outline-none focus:ring-2 focus:ring-primary-200"
                >
                  Xóa
                </button>
              </div>
            </div>
            <div
              class="group flex cursor-pointer flex-col items-center gap-3 rounded-2xl border-2 border-dashed border-primary-100 bg-white/70 p-6 text-center transition duration-200 focus-within:border-primary-300 focus-within:shadow hover:border-primary-300 hover:bg-primary-50"
              data-json-card="context"
              tabindex="0"
              role="button"
              aria-label="Nhập file Context JSON"
            >
              <input type="file" accept="application/json" class="hidden" data-json-input="context" />
              <span class="text-xs font-semibold uppercase tracking-wide text-primary-700">Context JSON</span>
              <p class="text-sm font-semibold text-slate-900">Chọn tệp context.json</p>
              <p class="max-w-[16rem] text-xs text-slate-500" data-json-status="context">Chưa chọn file</p>
              <div class="flex flex-wrap items-center justify-center gap-2">
                <button
                  type="button"
                  data-json-select="context"
                  class="rounded-full bg-primary-600 px-4 py-1.5 text-xs font-semibold text-white transition hover:bg-primary-500 focus:outline-none focus:ring-2 focus:ring-primary-200"
                >
                  Chọn file
                </button>
                <button
                  type="button"
                  data-json-export="context"
                  class="rounded-full border border-primary-200 px-4 py-1.5 text-xs font-semibold text-primary-600 transition hover:bg-primary-50 focus:outline-none focus:ring-2 focus:ring-primary-200"
                >
                  Luu JSON
                </button>
                <button
                  type="button"
                  data-json-clear="context"
                  class="rounded-full border border-slate-200 px-4 py-1.5 text-xs font-semibold text-slate-500 transition hover:border-slate-300 hover:text-slate-700 focus:outline-none focus:ring-2 focus:ring-primary-200"
                >
                  Xóa
                </button>
              </div>
            </div>
            <div
              class="group flex cursor-pointer flex-col items-center gap-3 rounded-2xl border-2 border-dashed border-primary-100 bg-white/70 p-6 text-center transition duration-200 focus-within:border-primary-300 focus-within:shadow hover:border-primary-300 hover:bg-primary-50"
              data-json-card="personas"
              tabindex="0"
              role="button"
              aria-label="Nhập file Personas JSON"
            >
              <input type="file" accept="application/json" class="hidden" data-json-input="personas" />
              <span class="text-xs font-semibold uppercase tracking-wide text-primary-700">Personas JSON</span>
              <p class="text-sm font-semibold text-slate-900">Chọn tệp personas.json</p>
              <p class="max-w-[16rem] text-xs text-slate-500" data-json-status="personas">Chưa chọn file</p>
              <div class="flex flex-wrap items-center justify-center gap-2">
                <button
                  type="button"
                  data-json-select="personas"
                  class="rounded-full bg-primary-600 px-4 py-1.5 text-xs font-semibold text-white transition hover:bg-primary-500 focus:outline-none focus:ring-2 focus:ring-primary-200"
                >
                  Chọn file
                </button>
                <button
                  type="button"
                  data-json-export="personas"
                  class="rounded-full border border-primary-200 px-4 py-1.5 text-xs font-semibold text-primary-600 transition hover:bg-primary-50 focus:outline-none focus:ring-2 focus:ring-primary-200"
                >
                  Luu JSON
                </button>
                <button
                  type="button"
                  data-json-clear="personas"
                  class="rounded-full border border-slate-200 px-4 py-1.5 text-xs font-semibold text-slate-500 transition hover:border-slate-300 hover:text-slate-700 focus:outline-none focus:ring-2 focus:ring-primary-200"
                >
                  Xóa
                </button>
              </div>
            </div>
          </div>
        </section>

        <section class="space-y-8">
          <div class="flex flex-wrap gap-3" role="tablist">
            <button
              type="button"
              data-tab-target="skeleton"
              class="rounded-full border border-primary-200 bg-primary-600 px-5 py-2 text-sm font-semibold text-white shadow transition hover:bg-primary-500 focus:outline-none focus:ring-2 focus:ring-primary-200"
            >
              Skeleton
            </button>
            <button
              type="button"
              data-tab-target="context"
              class="rounded-full border border-primary-200 bg-white px-5 py-2 text-sm font-semibold text-primary-600 transition hover:border-primary-300 hover:text-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-200"
            >
              Context
            </button>
            <button
              type="button"
              data-tab-target="personas"
              class="rounded-full border border-primary-200 bg-white px-5 py-2 text-sm font-semibold text-primary-600 transition hover:border-primary-300 hover:text-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-200"
            >
              Personas
            </button>
          </div>

          <div class="rounded-3xl border border-slate-200 bg-white/90 p-8 shadow-lg">
            <section data-panel="skeleton" class="space-y-8">
              <header class="space-y-1">
                <h2 class="text-2xl font-semibold text-slate-900">Skeleton</h2>
                <p class="text-sm text-slate-600">Thông tin tổng quan và danh sách Canon Event.</p>
              </header>
              <form data-form="skeleton" class="space-y-8">
                <div class="grid gap-4 md:grid-cols-2" data-basic-fields="skeleton"></div>
                <div class="space-y-4">
                  <div class="flex items-center justify-between">
                    <h3 class="text-lg font-semibold text-slate-900">Canon Events</h3>
                    <button
                      type="button"
                      data-add-event
                      class="inline-flex items-center gap-2 rounded-full border border-primary-200 px-4 py-2 text-xs font-semibold text-primary-600 transition hover:bg-primary-50 focus:outline-none focus:ring-2 focus:ring-primary-200"
                    >
                      + Thêm canon event
                    </button>
                  </div>
                  <div class="space-y-5" data-list="canon-events"></div>
                </div>
                <div class="flex justify-end gap-3">
                  <button
                    type="button"
                    data-next-tab="context"
                    class="inline-flex items-center gap-2 rounded-full bg-primary-600 px-5 py-2 text-sm font-semibold text-white transition hover:bg-primary-500 focus:outline-none focus:ring-2 focus:ring-primary-200"
                  >
                    Sang Context →
                  </button>
                </div>
              </form>
            </section>

            <section data-panel="context" class="hidden space-y-8">
              <header class="space-y-1">
                <h2 class="text-2xl font-semibold text-slate-900">Context</h2>
                <p class="text-sm text-slate-600">Bối cảnh, resource và điều kiện hiện trường.</p>
              </header>
              <form data-form="context" class="space-y-8">
                <div class="grid gap-4 md:grid-cols-2" data-basic-fields="context"></div>
                <div class="rounded-2xl border border-slate-200 bg-white/70 p-5 shadow-inner">
                  <h3 class="text-base font-semibold text-slate-900">Bối cảnh (Scene)</h3>
                  <div class="mt-4 grid gap-4 md:grid-cols-2" data-scene-fields></div>
                </div>
                <div class="rounded-2xl border border-slate-200 bg-white/70 p-5 shadow-inner">
                  <h3 class="text-base font-semibold text-slate-900">Sự kiện ban đầu</h3>
                  <div class="mt-4 grid gap-4 md:grid-cols-2" data-index-event-fields></div>
                </div>
                <div class="grid gap-4 md:grid-cols-2" data-context-notes></div>
                <div class="space-y-4">
                  <div class="flex items-center justify-between">
                    <h3 class="text-lg font-semibold text-slate-900">Nguồn lực khả dụng</h3>
                    <button
                      type="button"
                      data-add-resource
                      class="inline-flex items-center gap-2 rounded-full border border-primary-200 px-4 py-2 text-xs font-semibold text-primary-600 transition hover:bg-primary-50 focus:outline-none focus:ring-2 focus:ring-primary-200"
                    >
                      + Thêm nhóm resource
                    </button>
                  </div>
                  <div class="space-y-5" data-list="resources"></div>
                </div>
                <div class="flex flex-wrap justify-between gap-3">
                  <button
                    type="button"
                    data-prev-tab="skeleton"
                    class="inline-flex items-center gap-2 rounded-full border border-primary-200 px-5 py-2 text-sm font-semibold text-primary-600 transition hover:bg-primary-50 focus:outline-none focus:ring-2 focus:ring-primary-200"
                  >
                    ← Về Skeleton
                  </button>
                  <button
                    type="button"
                    data-next-tab="personas"
                    class="inline-flex items-center gap-2 rounded-full bg-primary-600 px-5 py-2 text-sm font-semibold text-white transition hover:bg-primary-500 focus:outline-none focus:ring-2 focus:ring-primary-200"
                  >
                    Sang Personas →
                  </button>
                </div>
              </form>
            </section>

            <section data-panel="personas" class="hidden space-y-8">
              <header class="space-y-1">
                <h2 class="text-2xl font-semibold text-slate-900">Personas</h2>
                <p class="text-sm text-slate-600">Danh sách nhân vật và đặc điểm hành vi.</p>
              </header>
              <form data-form="personas" class="space-y-8">
                <div class="grid gap-4 md:grid-cols-2" data-basic-fields="personas"></div>
                <div class="space-y-4">
                  <div class="flex items-center justify-between">
                    <h3 class="text-lg font-semibold text-slate-900">Danh sách Persona</h3>
                    <button
                      type="button"
                      data-add-persona
                      class="inline-flex items-center gap-2 rounded-full border border-primary-200 px-4 py-2 text-xs font-semibold text-primary-600 transition hover:bg-primary-50 focus:outline-none focus:ring-2 focus:ring-primary-200"
                    >
                      + Thêm persona
                    </button>
                  </div>
                  <div class="space-y-5" data-list="personas"></div>
                </div>
                <div class="flex flex-wrap justify-between gap-3">
                  <button
                    type="button"
                    data-prev-tab="context"
                    class="inline-flex items-center gap-2 rounded-full border border-primary-200 px-5 py-2 text-sm font-semibold text-primary-600 transition hover:bg-primary-50 focus:outline-none focus:ring-2 focus:ring-primary-200"
                  >
                    ← Về Context
                  </button>
                  <button
                    type="button"
                    data-save-case
                    class="inline-flex items-center gap-2 rounded-full bg-emerald-600 px-6 py-2 text-sm font-semibold text-white transition hover:bg-emerald-500 focus:outline-none focus:ring-2 focus:ring-emerald-200 disabled:cursor-not-allowed disabled:bg-emerald-400 disabled:opacity-60"
                  >
                    Lưu case
                  </button>
                </div>
              </form>
            </section>
          </div>
        </section>
      </div>
    </main>
  </div>
  <div
    data-draft-modal
    class="fixed inset-0 z-50 hidden items-center justify-center bg-slate-900/40 px-6 py-8"
    role="dialog"
    aria-modal="true"
  >
    <div class="relative max-w-2xl rounded-3xl bg-white p-6 shadow-2xl">
      <button
        type="button"
        data-close-draft
        class="absolute right-4 top-4 rounded-full bg-slate-100 px-2 py-1 text-xs font-semibold text-slate-500 hover:bg-slate-200"
        aria-label="Đóng"
      >
        &#10005;
      </button>
      <form data-draft-form class="space-y-5">
        <header class="space-y-2">
          <span class="inline-flex items-center gap-2 rounded-full bg-emerald-100 px-3 py-1 text-[11px] font-semibold uppercase tracking-wide text-emerald-700">
            Agent gợi ý case
          </span>
          <h2 class="text-xl font-semibold text-slate-900">Sinh case tự động</h2>
          <p class="text-sm text-slate-600">
            Mô tả chủ đề, nhân vật mong muốn hoặc các chi tiết khác để hệ thống sinh ra skeleton, context và personas tương ứng.
          </p>
        </header>
        <div class="space-y-3">
          <label class="flex flex-col gap-2 text-left">
            <span class="text-xs font-semibold uppercase tracking-wide text-slate-500">Prompt tự do</span>
            <textarea
              data-draft-prompt
              rows="4"
              placeholder="Ví dụ: Tạo case về khám răng định kỳ với 3 nhân vật: bác sĩ hướng dẫn, điều dưỡng hỗ trợ và bệnh nhân cao tuổi."
              class="w-full rounded-xl border border-slate-200 bg-white/80 px-3 py-2 text-sm text-slate-700 placeholder:text-slate-400 focus:border-emerald-200 focus:outline-none focus:ring-2 focus:ring-emerald-200"
            ></textarea>
          </label>
          <div class="grid gap-3 md:grid-cols-3">
            <label class="flex flex-col gap-2 text-left">
              <span class="text-xs font-semibold uppercase tracking-wide text-slate-500">Chủ đề (tùy chọn)</span>
              <input
                type="text"
                data-draft-topic
                placeholder="VD: Khám răng định kỳ tại phòng khám ABC"
                class="rounded-xl border border-slate-200 bg-white/80 px-3 py-2 text-sm text-slate-700 placeholder:text-slate-400 focus:border-emerald-200 focus:outline-none focus:ring-2 focus:ring-emerald-200"
              />
            </label>
            <label class="flex flex-col gap-2 text-left">
              <span class="text-xs font-semibold uppercase tracking-wide text-slate-500">Số nhân vật dự kiến</span>
              <input
                type="number"
                min="1"
                data-draft-persona-count
                placeholder="Mặc định 3"
                class="rounded-xl border border-slate-200 bg-white/80 px-3 py-2 text-sm text-slate-700 placeholder:text-slate-400 focus:border-emerald-200 focus:outline-none focus:ring-2 focus:ring-emerald-200"
              />
            </label>
            <label class="flex flex-col gap-2 text-left">
              <span class="text-xs font-semibold uppercase tracking-wide text-slate-500">Địa điểm chính (tùy chọn)</span>
              <input
                type="text"
                data-draft-location
                placeholder="VD: Phòng khám nha khoa Quận 3"
                class="rounded-xl border border-slate-200 bg-white/80 px-3 py-2 text-sm text-slate-700 placeholder:text-slate-400 focus:border-emerald-200 focus:outline-none focus:ring-2 focus:ring-emerald-200"
              />
            </label>
          </div>
        </div>
        <footer class="flex flex-wrap items-center justify-between gap-3">
          <p data-draft-status class="text-xs text-slate-500"></p>
          <div class="flex gap-3">
            <button
              type="button"
              data-close-draft
              class="rounded-full border border-slate-200 px-4 py-2 text-sm font-semibold text-slate-500 transition hover:border-slate-300 hover:text-slate-700"
            >
              Hủy
            </button>
            <button
              type="submit"
              data-draft-submit
              class="inline-flex items-center gap-2 rounded-full bg-emerald-600 px-5 py-2 text-sm font-semibold text-white transition hover:bg-emerald-500 focus:outline-none focus:ring-2 focus:ring-emerald-200"
            >
              Sinh case
            </button>
          </div>
        </footer>
      </form>
    </div>
  </div>
  
  <script src="/static/nhap-case.js" defer></script>
</body>
</html>